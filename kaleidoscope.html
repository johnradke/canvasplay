<!DOCTYPE html>
<html>
<head>
    <title>kaleidescope</title>
</head>
<body>
    <canvas id="canvas" style="border:1px solid #aaa;"></canvas>
</body>

<script src="script/bedrock.js"></script>
<script src="script/canvasproxy.js"></script>
<script>
window.onload = function() {
    var cv = new CanvasProxy($.id('canvas'), { 
        fillScreen: true,
        centerOrigin: true
    });
    var lastPos = null;

    cv.eachFrame = function() {
        if (this.isMouseDown()) {
            if (lastPos) {
                var pos = this.getMousePos();
                this.drawLine(lastPos.x, lastPos.y, pos.x, pos.y);
                this.drawLine(-lastPos.x, lastPos.y, -pos.x, pos.y);
                this.drawLine(lastPos.x, -lastPos.y, pos.x, -pos.y);
                this.drawLine(-lastPos.x, -lastPos.y, -pos.x, -pos.y);

                this.drawLine(lastPos.y, lastPos.x, pos.y, pos.x);
                this.drawLine(-lastPos.y, lastPos.x, -pos.y, pos.x);
                this.drawLine(lastPos.y, -lastPos.x, pos.y, -pos.x);
                this.drawLine(-lastPos.y, -lastPos.x, -pos.y, -pos.x);
            }
            lastPos = this.getMousePos();
        }
        else {
            lastPos = null;
        }
    }

    cv.startAnimation();
};
</script>

</html>